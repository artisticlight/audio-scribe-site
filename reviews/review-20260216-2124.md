# Code Review: audio-scribe-site

**Date:** 2026-02-16
**Branch:** `main`
**Scope:** Full codebase (all untracked files since initial commit)
**Reviewers:** Security, Bugs, Performance, Code Quality, Pattern Conformity agents

---

## CRITICAL

### 1. `provideClientHydration()` used without SSR — runtime error

**Category:** Bug
**File:** `src/app/app.config.ts:13`

`provideClientHydration()` is an Angular SSR API. This project has no SSR setup — no `server.ts`, no `app.config.server.ts`, and `angular.json` uses a client-only `browser` entry point. Including it in a CSR-only app will cause runtime errors or unpredictable hydration mismatches.

**Fix:** Remove `provideClientHydration()` and its import from `app.config.ts`.

---

### 2. Child route `redirectTo` fails for `/documentation` (no trailing slash)

**Category:** Bug
**File:** `src/app/app.routes.ts:13-14`

The `documentation` route uses `loadComponent` with `children` including `{ path: '', redirectTo: 'getting-started', pathMatch: 'full' }`. Navigating to `/documentation` (without trailing slash) does not match the child empty path with `pathMatch: 'full'`, leaving the `<router-outlet>` blank. The redirect only fires for `/documentation/`.

**Fix:** Add a separate redirect route at the parent level:

```typescript
{ path: 'documentation', redirectTo: 'documentation/getting-started', pathMatch: 'full' },
{ path: 'documentation', loadComponent: ..., children: [...] }
```

---

### 3. Material Icons font is render-blocking

**Category:** Performance
**File:** `src/index.html:18`

The entire Material Icons icon font is loaded via external CDN with no `display=optional`, no `font-display` hint, and no `preload`. Since icons appear in the sticky toolbar, this blocks rendering on every page load.

**Fix:** Switch to self-hosted SVG icons for the ~12 icons used, or at minimum use `display=swap` with `preload`. Consider the `material-symbols` variable font.

---

### 4. Missing explicit `optimization` with `inlineCritical` in production build

**Category:** Performance
**File:** `angular.json:66-80`

The production configuration lacks explicit `optimization` settings. `inlineCritical: true` extracts and inlines critical CSS into `<head>`, directly reducing time to first contentful paint — essential for a marketing landing page.

**Fix:** Add to the production configuration:

```json
"optimization": {
  "scripts": true,
  "styles": { "minify": true, "inlineCritical": true },
  "fonts": true
}
```

---

### 5. `@angular/material` in both `dependencies` and `devDependencies`

**Category:** Code Quality
**File:** `package.json`

`@angular/material` appears as `~21.1.4` in `dependencies` and `^21.1.4` in `devDependencies` with conflicting version ranges. This can cause unpredictable resolution and duplicate installations.

**Fix:** Remove the `devDependencies` entry. It belongs only in `dependencies`.

---

### 6. Privacy email hardcoded, bypassing `APP_CONFIG`

**Category:** Code Quality / Pattern
**File:** `src/app/pages/privacy/privacy.component.ts:82`

The privacy page hardcodes `privacy@audioscribe.app` directly in the template instead of using `APP_CONFIG.privacyEmail`. Every other component uses `APP_CONFIG` for branding constants.

**Fix:** Import `APP_CONFIG`, expose it as a class property, and use `config.privacyEmail` in the template.

---

## HIGH

### 7. `RouterLink` missing from `SupportComponent` — build will fail

**Category:** Bug
**File:** `src/app/pages/support/support.component.ts:13-20`

`support.component.html` uses `routerLink="/documentation"` but neither `RouterModule`, `RouterLink`, nor `RouterLinkActive` is in the component's `imports` array. With `strictTemplates: true`, this causes a **compile-time error**.

**Fix:** Add `RouterLink` to the imports array.

---

### 8. Dark mode not initialized from OS preference and not persisted

**Category:** Bug
**File:** `src/app/app.ts:42-45`

The dark mode signal defaults to `false` regardless of the user's OS `prefers-color-scheme`. Toggling dark mode is lost on page refresh because the state is never persisted. The feature is effectively broken across navigations.

**Fix:** Initialize from `localStorage`/`prefers-color-scheme` and persist on toggle.

---

### 9. Sidenav signal/DOM state can diverge after backdrop dismiss

**Category:** Bug
**File:** `src/app/app.html:2-9`

The sidenav uses one-way `[opened]` binding from a signal with only `(closed)` to sync back. Material's `mat-sidenav` manages its own internal state. Missing `(opened)` listener means the signal and the component's internal state can drift out of sync, preventing the sidenav from reopening.

**Fix:** Add `(opened)="isSidenavOpen.set(true)"` alongside the existing `(closed)` handler.

---

### 10. `CommonModule` imported but unused across all components

**Category:** Performance / Code Quality
**Files:** `src/app/app.ts:2`, `src/app/pages/home/home.component.ts:2`, `src/app/pages/documentation/documentation.component.ts:2`, `src/app/pages/privacy/privacy.component.ts:7`

All components use Angular 17+ control flow syntax (`@for`, `@if`) and do not reference any `CommonModule` exports. This is dead weight.

**Fix:** Remove `CommonModule` from the `imports` array in all components.

---

### 11. `RouterModule` used instead of standalone router directives

**Category:** Code Quality
**Files:** `src/app/app.ts:3`, `src/app/pages/home/home.component.ts:3`, `src/app/pages/documentation/documentation.component.ts:3`

Standalone components should import `RouterLink`, `RouterLinkActive`, and `RouterOutlet` individually, not the legacy `RouterModule` barrel.

**Fix:** Replace `RouterModule` with only the specific directives each component uses.

---

### 12. Unused Material module imports

**Category:** Code Quality
**Files:**
- `src/app/pages/support/support.component.ts` — `MatInputModule`, `MatFormFieldModule` unused
- `src/app/pages/documentation/getting-started/getting-started.component.ts` — `MatCardModule` unused
- `src/app/pages/documentation/documentation.component.ts` — `MatSidenavModule` unused

**Fix:** Remove unused imports.

---

### 13. Hero/toolbar `<img>` elements missing `width`/`height` attributes — CLS impact

**Category:** Performance
**Files:** `src/app/pages/home/home.component.html:31`, `src/app/app.html:39,105`

Images without HTML `width`/`height` attributes cause Cumulative Layout Shift. The hero logo is the LCP candidate and should also use `fetchpriority="high"`.

**Fix:** Add `width`/`height` attributes. Use `loading="lazy"` for below-fold images (App Store badge).

---

### 14. 10 infinite CSS animations ignore `prefers-reduced-motion`

**Category:** Performance / Accessibility
**Files:** `src/app/pages/home/home.component.scss:86-93`, `src/app/pages/home/home.component.html:32-35`

The hero waveform runs 10 infinite CSS animations that never pause and do not respect `prefers-reduced-motion`. The animation delays are computed via inline Angular bindings, re-evaluated every change detection cycle.

**Fix:** Add `@media (prefers-reduced-motion: reduce) { animation: none; }` and move delays to static SCSS with `@for`.

---

### 15. Missing `aria-label` on navigation landmarks

**Category:** Code Quality / Accessibility
**Files:** `src/app/app.html` — `mat-sidenav` and toolbar `nav` elements; `src/app/pages/documentation/documentation.component.html` — docs `aside`

Multiple `<nav>` landmarks lack `aria-label`, making them indistinguishable for screen readers.

**Fix:** Add descriptive `aria-label` attributes (e.g., `aria-label="Main navigation"`, `aria-label="Documentation sidebar"`).

---

### 16. `.gitignore` missing `.env` coverage

**Category:** Security
**File:** `.gitignore`

The current `.gitignore` does not include `.env`, `.env.*`, or similar patterns. Any future addition of environment files risks committing secrets.

**Fix:** Add `.env*` to `.gitignore`.

---

### 17. Hardcoded app name bypasses `APP_CONFIG` in multiple components

**Category:** Pattern Conformity
**Files:** `src/app/pages/privacy/privacy.component.ts`, `src/app/pages/documentation/getting-started/getting-started.component.ts`, `src/app/pages/documentation/features/features.component.ts`

These components hardcode "Audio Scribe" instead of using `APP_CONFIG.name`, breaking the centralized branding pattern used elsewhere.

**Fix:** Import and use `APP_CONFIG` consistently.

---

### 18. i18n missing on dynamic content arrays

**Category:** Pattern Conformity
**Files:**
- `src/app/pages/home/home.component.ts` — features array strings
- `src/app/pages/support/support.component.ts` — FAQs and support options strings

Template strings in TypeScript arrays are not wrapped with `$localize` and cannot be extracted by `ng extract-i18n`. The `i18n` attribute only works on HTML elements.

**Fix:** Use `$localize` tagged template literals for all user-facing strings in TypeScript:

```typescript
title: $localize`Email Support`
```

---

## MEDIUM

### 19. `i18n` + `{{ interpolation }}` mixed without translation files

**Category:** Bug
**Files:** `src/app/pages/home/home.component.html:94`, `src/app/pages/about/about.component.ts:13`

Elements like `<h1 i18n>About {{ config.name }}</h1>` mix `i18n` with interpolation. This works only when XLF translation files define the interpolation as a placeholder. Without the translation files (which don't exist yet), the build may fail or render incorrectly with `--localize`.

**Fix:** Generate translation source files with `ng extract-i18n` before using `--localize`.

---

### 20. Two font families loaded with unused weights

**Category:** Performance
**File:** `src/index.html:17`

Inter (5 weights) and Roboto (3 weights) are both loaded. Only Inter weights 400, 500, 600 are actually used. Roboto conflicts with the Material theme typography setting.

**Fix:** Reduce to `Inter:wght@400;500;600` and align Material theme typography.

---

### 21. Root `App` component uses Signals without `OnPush`

**Category:** Performance
**File:** `src/app/app.ts`

`App` uses signals (`isDarkMode`, `isSidenavOpen`) but does not use `ChangeDetectionStrategy.OnPush`. Without `OnPush`, signals trigger zone-based change detection on top of signal-based reactivity.

**Fix:** Add `changeDetection: ChangeDetectionStrategy.OnPush` to `App` and child components.

---

### 22. `currentYear` stale across midnight

**Category:** Code Quality
**File:** `src/app/app.ts:30`

`currentYear = new Date().getFullYear()` is computed once at instantiation. If a user leaves the tab open past midnight on Dec 31, the footer shows the wrong year.

**Fix:** Minor risk. Acceptable as-is, or compute in the template.

---

### 23. Toolbar/footer text missing `i18n` attributes

**Category:** Pattern Conformity
**File:** `src/app/app.html`

Static text in the toolbar and footer (brand name, section headings, copyright) is not marked with `i18n`, making it invisible to the translation pipeline.

**Fix:** Add `i18n` attribute to all user-visible static text.

---

### 24. `angular.json` schematics missing `standalone: true` default

**Category:** Pattern Conformity
**File:** `angular.json`

All schematics set `skipTests: true` but none set `standalone: true`. Angular 21 defaults to standalone, but explicitly setting it prevents any future ambiguity.

**Fix:** Add `"standalone": true` to component/directive/pipe schematic defaults.

---

### 25. Dynamic `mailto:` href construction

**Category:** Security
**File:** `src/app/pages/support/support.component.html`

Support email links are constructed from `APP_CONFIG` values without type enforcement. While currently safe (values are `as const` strings), the pattern lacks runtime validation.

**Fix:** Low risk given `as const`. Consider adding a type guard if config becomes dynamic.

---

## LOW

### 26. `navigationItems` labels missing `i18n`

**Category:** Pattern Conformity
**File:** `src/app/app.ts`

Navigation labels ("Home", "Documentation", etc.) are plain strings not wrapped with `$localize`.

**Fix:** Use `$localize` tagged template literals.

---

## Summary

| Severity | Count |
|----------|-------|
| CRITICAL | 6     |
| HIGH     | 12    |
| MEDIUM   | 7     |
| LOW      | 1     |
| **Total**| **26**|

### Top Priority Actions

1. Remove `provideClientHydration()` (build/runtime error)
2. Add `RouterLink` to `SupportComponent` (build-breaking)
3. Fix documentation route redirect (blank page)
4. Add `.env*` to `.gitignore` (security)
5. Remove `@angular/material` from `devDependencies` (dependency conflict)
6. Fix Material Icons render-blocking load (performance)
